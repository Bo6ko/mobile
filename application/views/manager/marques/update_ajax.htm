<div class="section">

    <div class="create-btn">
        <a href="{$smarty.const.WEB_PATH}manager/vehicule_marques" class="btn" role="button"><span>View all marks</span></a>
    </div>
    <div class="clear"></div>

    <div class="message" id="response"></div>

    <fieldset>
        <legend>Update marque</legend>

        <form>
            <ul>
                <li>
                    <div class="d1"><label for="marque_name">Name: </label></div>
                    <div class="d2"><input type="text" name="marque_name" id="marque_name" value="{if isset($data.marque_name)}{$data.marque_name|escape:'html'}{/if}" /></div>
                </li>


                <li>
                    <div class="d1"><label for="marque_slogan">Slogan: </label></div>
                    <div class="d2"><input type="text" name="marque_slogan" id="marque_slogan" value="{if isset($data.marque_slogan)}{$data.marque_slogan|escape:'html'}{/if}" /></div>
                </li>

                <div id="update-marque">Update</div>

            </ul>
        </form>

    </fieldset>


    <div class="clear"></div>


</div>

<script>

    $(document).ready(function(){


        $("#update-marque").on('click',function(){


            var response    = $("#response");

            response.html('izprashtane na zaqvka...').removeClass("error").removeClass("success");

            var button      = $(this);


        //   1
            var marque_name     = $("#marque_name").val();
            var marque_slogan   = $("#marque_slogan").val();
            var data1 = {
                marque_name     : marque_name,
                marque_slogan   : marque_slogan,
            }
            console.log('-----------------------');
            console.log(data1);
        //    2
            //var holder          = button.parents('ul');
            var holder          = button.parents('fieldset');
            var marque_name     = holder.find("input[name=marque_name]").val();
            var marque_slogan   = holder.find("input[name=marque_slogan]").val();

            var data2 = {
                marque_name     : marque_name,
                marque_slogan   : marque_slogan
            }
            console.log('-----------------------');
            console.log(data2);

        //    3
            var form          = button.parents('form');

            var data3          = form.serialize();

            console.log('-----------------------');
            console.log(data3);


            $.ajax({
                url			: 'http://mobile.localhost/manager/vehicule_marques/ajax/{$data.marque_id}',
                type		: "POST",
                dataType	: "json",
                data		: data3,
                success		: function( json ) {


                    if ( json.status ) {
                        // true
                        response.addClass("success");
                    } else{
                        // false
                        response.addClass("error");
                    }

                    response.html( json.message );

                    console.log(json);


                },
                error		: function(error) {
                    console.log(error);
                    console.log(error.responseText);
                }
            });
        });

    });

</script>